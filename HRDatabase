------------------------------------------
--DDL statement for table 'HR' database--
--------------------------------------------

SELECT F_NAME , L_NAME
FROM EMPLOYEES
WHERE ADDRESS LIKE '%Elgin, IL%';

SELECT F_NAME , L_NAME
FROM EMPLOYEES
WHERE B_DATE LIKE '197%';

SELECT F_NAME , L_NAME
FROM EMPLOYEES
WHERE (SALARY BETWEEN 60000 AND 70000) AND DEP_ID=5

SELECT F_NAME , L_NAME
FROM EMPLOYEES
ORDER BY DEP_ID

SELECT F_NAME , L_NAME, DEP_ID
FROM EMPLOYEES
ORDER BY DEP_ID DESC, L_NAME DESC

SELECT D.DEP_NAME , E.F_NAME, E.L_NAME
FROM EMPLOYEES as E, DEPARTMENTS as D
WHERE E.DEP_ID = D.DEPT_ID_DEP
ORDER BY D.DEP_NAME, E.L_NAME DESC;

Select * from employees

SELECT DEP_ID, COUNT(*)
AS YAPRAGIM
FROM EMPLOYEES
GROUP BY DEP_ID;

SELECT DEP_ID, COUNT(*) AS "NUM_EMPLOYEES", AVG(SALARY) AS "AVG_SALARY"
FROM EMPLOYEES
GROUP BY DEP_ID;

SELECT DEP_ID, COUNT(*) AS "NUM_EMPLOYEES", AVG(SALARY) AS "AVG_SALARY"
FROM EMPLOYEES
GROUP BY DEP_ID
HAVING COUNT(*) <4 
ORDER BY AVG_SALARY;

select * from employees where salary<avg(salary)
select * from employees where salary<(select AVG(salary)from employees)
select EMP_ID, F_NAME, L_NAME, SALARY 
from employees 
where SALARY < (select AVG(SALARY) 
                from employees;
SELECT * FROM EMPLOYEES


select EMP_ID, SALARY, ( select MAX(SALARY) from employees ) AS MAX_SALARY 
FROM EMPLOYEES;
select EMP_ID, SALARY, ( select MAX(SALARY) from employees ) AS MAX_SALARY FROM EMPLOYEES;

SELECT * from EMPLOYEES;
SELECT * from JOBS;

SELECT E.F_NAME, E.JOB_ID, J.JOB_TITLE
FROM EMPLOYEES AS E, JOBS AS J
WHERE E.JOB_ID = J.JOB_IDENT;

select * from employees where JOB_ID IN (select JOB_IDENT from jobs);

select * from employees where JOB_ID IN (select JOB_IDENT from jobs where JOB_TITLE= 'Jr. Designer');

select JOB_TITLE, MIN_SALARY,MAX_SALARY,JOB_IDENT from jobs where JOB_IDENT IN (select JOB_ID from employees where YEAR(B_DATE)>1976 );
select JOB_TITLE, MIN_SALARY,MAX_SALARY,JOB_IDENT from jobs where JOB_IDENT IN (select JOB_ID from employees where YEAR(B_DATE)>1976 and (SEX)='F');

select * from employees;
SELECT * FROM JOB_HISTORY;
select * from departments;
select * from locations;
select * from jobs;

select E.F_NAME, E.L_NAME, JH.START_DATE
from employees AS E INNER JOIN job_history AS JH ON E.EMP_ID=JH.EMPL_ID
where E.DEP_ID='5';

select E.F_NAME, E.L_NAME, JH.START_DATE, J.JOB_TITLE
from employees AS E 
INNER JOIN job_history AS JH ON E.EMP_ID=JH.EMPL_ID
INNER JOIN JOBS AS J on E.JOB_ID=J.JOB_IDENT
where E.DEP_ID='5';

SELECT E.EMP_ID, E.F_NAME, E.L_NAME, E.DEP_ID, D.DEP_NAME
FROM EMPLOYEES AS E 
LEFT OUTER JOIN DEPARTMENTS AS D ON E.DEP_ID=D.DEPT_ID_DEP;

SELECT E.EMP_ID, E.F_NAME, E.L_NAME, E.DEP_ID, D.DEP_NAME
FROM EMPLOYEES AS E 
LEFT OUTER JOIN DEPARTMENTS AS D ON E.DEP_ID=D.DEPT_ID_DEP
WHERE YEAR(E.B_DATE)<'1980';

SELECT E.EMP_ID, E.F_NAME, E.L_NAME, E.DEP_ID, D.DEP_NAME
FROM EMPLOYEES AS E 
LEFT OUTER JOIN DEPARTMENTS AS D ON E.DEP_ID=D.DEPT_ID_DEP AND YEAR(E.B_DATE)<'1980';

SELECT E.EMP_ID, E.F_NAME, E.L_NAME, D.DEP_NAME
FROM EMPLOYEES AS E 
full JOIN DEPARTMENTS AS D  ON E.DEP_ID=D.DEPT_ID_DEP AND YEAR(E.sex)='m';

